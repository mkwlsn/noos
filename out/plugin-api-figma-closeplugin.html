<header><h1>closePlugin</h1></header><p>Closes the plugin. You should always call this function once your plugin is done running. When called, any UI that's open will be closed and any <code>setTimeout</code> or <code>setInterval</code> timers will be cancelled.</p><h2 class="anchor anchorWithStickyNavbar_loeA" id="signature"><a class="hash-link" href="#signature" title="Direct link to heading"></a>Signature</h2><h3 class="property"><a href="/plugin-docs/api/properties/figma-closeplugin/">closePlugin</a>(message?: string): void</h3><h2 class="anchor anchorWithStickyNavbar_loeA" id="parameters"><a class="hash-link" href="#parameters" title="Direct link to heading"></a>Parameters</h2><h3 class="anchor anchorWithStickyNavbar_loeA" id="message"><a class="hash-link" href="#message" title="Direct link to heading"></a>message</h3><p>Optional -- display a visual bell toast with the message after the plugin closes.</p><h2 class="anchor anchorWithStickyNavbar_loeA" id="remarks"><a class="hash-link" href="#remarks" title="Direct link to heading"></a>Remarks</h2><p>Calling <code>figma.closePlugin()</code> disables callbacks and Figma APIs. It does not, however, abort the plugin. Any lines of Javascript after this call will also run. For example, consider the following plugin that expects the user to have one layer selected:</p><div class="codeBlockContainer_X7hc language-ts theme-code-block"><div class="codeBlockTitle_B2tn" style="color: rgb(248, 248, 242); background-color: rgb(40, 42, 54);">Simple closePlugin</div><div class="codeBlockContent_vqWU" style="color: rgb(248, 248, 242); background-color: rgb(40, 42, 54);"><pre tabindex="0" class="prism-code language-ts codeBlock_wPnj thin-scrollbar"><code class="codeBlockLines_fQUY"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token keyword control-flow" style="color: rgb(189, 147, 249); font-style: italic;">if</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">figma</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token property-access">currentPage</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token property-access">selection</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator">!==</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">  figma</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token method function property-access" style="color: rgb(80, 250, 123);">closePlugin</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">figma</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token property-access">currentPage</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token property-access">selection</span><span class="token punctuation" style="color: rgb(248, 248, 242);">[</span><span class="token number">0</span><span class="token punctuation" style="color: rgb(248, 248, 242);">]</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token property-access">opacity</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.5</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>This will not work. The last line will still run, but will throw an exception because access to <code>figma.currentPage</code> has been disabled. As such, it is not recommended to run any code after calling <code>figma.closePlugin()</code>.</p><p>A simple way to easily exit your plugin is to wrap your plugin in a function, instead of running code at the top-level, and always follow <code>figma.closePlugin()</code> with a <code>return</code> statement:</p><div class="codeBlockContainer_X7hc language-ts theme-code-block"><div class="codeBlockTitle_B2tn" style="color: rgb(248, 248, 242); background-color: rgb(40, 42, 54);">Early return</div><div class="codeBlockContent_vqWU" style="color: rgb(248, 248, 242); background-color: rgb(40, 42, 54);"><pre tabindex="0" class="prism-code language-ts codeBlock_wPnj thin-scrollbar"><code class="codeBlockLines_fQUY"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">function</span><span class="token plain"> </span><span class="token function" style="color: rgb(80, 250, 123);">main</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">  </span><span class="token keyword control-flow" style="color: rgb(189, 147, 249); font-style: italic;">if</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">figma</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token property-access">currentPage</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token property-access">selection</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator">!==</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    figma</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token method function property-access" style="color: rgb(80, 250, 123);">closePlugin</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword control-flow" style="color: rgb(189, 147, 249); font-style: italic;">return</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">  figma</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token property-access">currentPage</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token property-access">selection</span><span class="token punctuation" style="color: rgb(248, 248, 242);">[</span><span class="token number">0</span><span class="token punctuation" style="color: rgb(248, 248, 242);">]</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token property-access">opacity</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.5</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token function" style="color: rgb(80, 250, 123);">main</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>It's good practice to have all input validation done at the start of the plugin. However, there may be cases where the plugin may need to close after a chain of multiple function calls. If you expect to have to close the plugin deep within your code, but don't want to necessarily want the user to see an error, the example above will not be sufficient.</p><p>One alternative is to use a top-level try-catch statement. However, you will need to be responsible for making sure that there are no usages of try-catch between the top-level try-catch and the call to <code>figma.closePlugin()</code>, or to pass along the close command if necessary. Example:</p><div class="codeBlockContainer_X7hc language-ts theme-code-block"><div class="codeBlockTitle_B2tn" style="color: rgb(248, 248, 242); background-color: rgb(40, 42, 54);">Top-level try-catch</div><div class="codeBlockContent_vqWU" style="color: rgb(248, 248, 242); background-color: rgb(40, 42, 54);"><pre tabindex="0" class="prism-code language-ts codeBlock_wPnj thin-scrollbar"><code class="codeBlockLines_fQUY"><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">const</span><span class="token plain"> </span><span class="token constant" style="color: rgb(189, 147, 249);">CLOSE_PLUGIN_MSG</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color: rgb(255, 121, 198);">"_CLOSE_PLUGIN_"</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">function</span><span class="token plain"> </span><span class="token function" style="color: rgb(80, 250, 123);">someNestedFunctionCallThatClosesThePlugin</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">  </span><span class="token keyword control-flow" style="color: rgb(189, 147, 249); font-style: italic;">throw</span><span class="token plain"> </span><span class="token constant" style="color: rgb(189, 147, 249);">CLOSE_PLUGIN_MSG</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword" style="color: rgb(189, 147, 249); font-style: italic;">function</span><span class="token plain"> </span><span class="token function" style="color: rgb(80, 250, 123);">main</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">  </span><span class="token function" style="color: rgb(80, 250, 123);">someNestedFunctionCallThatClosesThePlugin</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token keyword control-flow" style="color: rgb(189, 147, 249); font-style: italic;">try</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">  </span><span class="token function" style="color: rgb(80, 250, 123);">main</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color: rgb(189, 147, 249); font-style: italic;">catch</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">e</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">  </span><span class="token keyword control-flow" style="color: rgb(189, 147, 249); font-style: italic;">if</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token plain">e </span><span class="token operator">===</span><span class="token plain"> </span><span class="token constant" style="color: rgb(189, 147, 249);">CLOSE_PLUGIN_MSG</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    figma</span><span class="token punctuation" style="color: rgb(248, 248, 242);">.</span><span class="token method function property-access" style="color: rgb(80, 250, 123);">closePlugin</span><span class="token punctuation" style="color: rgb(248, 248, 242);">(</span><span class="token punctuation" style="color: rgb(248, 248, 242);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color: rgb(189, 147, 249); font-style: italic;">else</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(248, 248, 242);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token comment" style="color: rgb(98, 114, 164);">// &gt;&gt; DO NOT LEAVE THIS OUT &lt;&lt;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token comment" style="color: rgb(98, 114, 164);">// If we caught any other kind of exception,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token comment" style="color: rgb(98, 114, 164);">// it's a real error and should be passed along.</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">    </span><span class="token keyword control-flow" style="color: rgb(189, 147, 249); font-style: italic;">throw</span><span class="token plain"> e</span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain">  </span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(248, 248, 242);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(248, 248, 242);">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div>